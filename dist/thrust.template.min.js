define("thrust/template/config",["require","exports"],function(a,b){b.resolve=["cfg","data"],b.conventions=["thrust/template/convention/template","thrust/template/convention/knockout.engine"],b.types={doT:"doT",precompiled:!0},b.evaluators={doT:{left:"{{= ",right:"}}"}},b.defaultType="doT",b.baseUrl="",b.extension=".tmpl"}),define("thrust/template/main",["require","exports","thrust/util","domReady","thrust/facade","./config"],function(a,b,c,d,e,f){var g=c,h=g._,i=d,j=e,k=f;b.className="Template",k;var l="long",m="short",n="id",o=h.merge,p=g.format,q=h.each,r=h.bind,s=g.when,t=h.reduce,u=h.memoize,v=h.map,w=h.extend,x=function(a,b){var c=this,d=(c.shortName(a)+"."+(b||c.config.defaultType)+c.config.extension).toLowerCase();return d},y=function(a){var b=this,c=t(b.templateTypes,function(a,c){return a.replace("."+c.toLowerCase()+b.config.extension,"")},a.toLowerCase()).toLowerCase();return c},z=function(a){var b=this,c=b.shortName(a).replace(/\//g,"-");return c},A=function(){function b(b,c){var d=this,e=this.config=b.template;d.templateTypes=v(e.types,function(a,b){return b}),d.templates={"long":{},"short":{},id:{}},d.longName=u(r(x,d)),d.shortName=u(r(y,d)),d.templateId=u(r(z,d)),d.engines={},d.data=c,a([e.templatePaths[e.defaultType]||"thrust/template/"+e.defaultType],function(a){d.engines[e.defaultType]=a,i(function(){h(document.getElementsByTagName("script")).filter(function(a){return!!a.getAttribute("data-template")}).each(r(d.createFromDomNode,d))})})}return b.prototype.get=function(a){var b=null,c=this,d=c.templates;return(b=d.long[c.longName(a)])?b:(b=d.short[c.shortName(a)])?b:(b=d.id[c.templateId(a)])?b:null},b.prototype.set=function(a,b,c,d){var e=this,f=e.shortName(a),g=e.templateId(a),h=e.longName(a,b),i=e.templates;i.long[h]=i.short[f]=i.id[g]={name:a,shortName:a,id:g,type:b,html:d,compiled:c}},b.prototype.has=function(a){var b=this;return!!b.get(a)},b.prototype.newTemplate=function(a,b,c,d){var e=this,f=e.get(a);if(!f)if(b=="precompiled")e.set(a,b,c,c.toString());else{var g,h=this.compile(c,d);e.set(a,b,h,c)}return e.get(a)},b.prototype.compile=function(a,b){var c=this,d;return b||(b=c.engines[c.config.defaultType]),typeof b=="function"?d=b:typeof b.template=="function"&&(d=b.template),d(a)},b.prototype.fetch=function(b,c){var d=this,c=c||d.config.defaultType,e=d.shortName(b),f=d.longName(b,c),g,h=s.defer();return(g=d.get(b))?(h.resolve(g),h.promise):(d.data.get(d.config.baseUrl+f,{contentType:"text/plain",dataType:"text",silent:!0}).then(s.apply(function(e){if(c=="precompiled"){var f=d.newTemplate(b,c,e);h.resolve(f)}else if(d.engines[c]){var f=d.newTemplate(b,c,e,d.engines[c]);h.resolve(f)}else a([d.config.templatePaths[c]||"thrust/template/"+c],function(a){d.engines[c]=a;var f=d.newTemplate(b,c,e,a);h.resolve(f)})}),h.reject),h.promise)},b.prototype.createFromDomNode=function(a){var b=this;b.newTemplate(a.getAttribute("data-template"),a.getAttribute("data-type"),a.text)},b.prototype.createFacade=function(a,b,c){var d=a.template,e=c.template=new B(b,this);return b.templates={fetch:r(d.fetch,d),get:r(d.get,d),has:r(d.has,d)},e},b.config=k,b}();b.Template=A;var B=function(){var a=j.createFacade(function(a,b){this.name=a.name+"-template",this.module=a,this.parent=b,this.__conventions=b.__conventions,w(this,{fetch:r(b.fetch,b),get:r(b.get,b),has:r(b.has,b)})});return a}()}),define("thrust/template",["thrust/template/main"],function(a){return a}),define("thrust/template/convention/template",["require","exports","thrust/convention","thrust/util"],function(a,b,c,d){var e=c,f=e.Convention,g=d,h=g._,i="templates",j=g.when,k=h.each,l=Object.prototype.hasOwnProperty,m=h.find,n={properties:[i],init:function(a,b){var c=j.defer(),d=b.convention(i),e=g.invert(d),f=b.instance;if(d){var l=[];k(d,function(b){typeof b=="string"&&l.push(a.fetch(b))}),a.loadingPromise=j.all(l).then(function(a){h.forOwn(e,function(b,c){var d=m(a,function(a){return a.shortName===c||a.name===c});f.templates[c]=d.compiled})})}return null},ready:function(a,b){return a.loadingPromise||undefined}};b.subscription=new f(n)}),define("thrust/template/convention/knockout.engine",["require","exports","thrust/convention","thrust/util","knockout"],function(a,b,c,d,e){var f=c,g=f.Convention,h=d,i=h._,j=e,k=h.when,l=i.each,m=Object.prototype.hasOwnProperty,n=i.find,o={},p=function(a){var b=j.templateSources.thrustTemplate=function(a){this.template=a};b.prototype={text:function(){var a=this;if(arguments.length===0)return a.template.html;a.template.html=arguments[0]},data:function(a){var b=this;b.template.data||(b.template.data={});if(arguments.length===1)return b.template.data[a];b.template.data[a]=arguments[1]}};var c=j.nativeTemplateEngine.instance,d=j.conventionTemplateEngine=function(){};d.prototype=j.utils.extend(new j.templateEngine,{renderTemplateSource:function(b,d,e){if(b.template){var f=this.evaluators;f||(this.evaluators=f=a.evaluators[a.defaultType]);var g=b.data("precompiled");g||(g=a.compile("{{ with($data) { }} "+b.text()+" {{ } }}"),b.data("precompiled",g));var h=b.template.compiled(d).replace(/\s+/g," ");return j.utils.parseHtmlFragment(h)}return c.renderTemplateSource.apply(c,arguments)},createJavaScriptEvaluatorBlock:function(b){if(!this.evaluatorCache){var c=a.evaluators[a.defaultType];this.evaluatorCache=c.left+b+c.right}return this.evaluatorCache},makeTemplateSource:function(d,e){if(typeof d=="string"){var f=a.get(d);if(f)return new b(f)}return c.makeTemplateSource.apply(c,arguments)}}),j.setTemplateEngine(new j.conventionTemplateEngine)},q={countdown:function(a){return p(a.template),null}};b.subscription=new g(q)});