/*! thrust-js - v0.1.0 - 2013-01-01 */define("thrust/mediator/config",["require","exports"],function(e,t){t.resolve=["name","cfg"],t.conventions=["thrust/mediator/convention/container","thrust/mediator/convention/subscription","thrust/mediator/convention/autostart","thrust/mediator/convention/dependent.modules"]}),define("thrust/mediator/main",["require","exports","thrust/util","thrust/log","thrust/events","thrust/facade","has","thrust/config","./config"],function(e,t,n,r,i,s,o,u,a){var f=n,l=f._,c=r,h=i,p=h.Events,d=s,v=o,m=u,g=a;t.className="Mediator";var y=f.format,b=l.extend,w=f.type,E=f.when,S=l.memoize,x,T=Array.prototype.slice,N=m,C=function(){var e=d.createFacade(function(e,t){this.name=e.name,this.module=e,this.parent=t,this.__conventions=t.__conventions,this._callbacks=t._callbacks,this.initEvents()});return l.extend(e.prototype,p),e.prototype.init=function(e){return this._internalSubscriptions||(this._internalSubscriptions=[]),null},e.prototype.start=e.prototype.init,e.prototype.subscribe=function(e,t,n){this._internalSubscriptions.push({events:e,callback:t,context:n}),p.subscribe.call(this,e,t,n)},e.prototype.stop=function(e){if(this._internalSubscriptions){for(var t=this._internalSubscriptions.length-1;t>=0;t--){var n=this._internalSubscriptions[t];this.unsubscribe(n.events,n.callback,n.context)}delete this._internalSubscriptions}return null},e}(),k=function(){function e(e,t){var n=this,r=t&&t.url&&t.url.path;n.name=e,!1,n.initEvents(),n.subscribe("thrust/ready",function(){!1})}return e.prototype.initEvents=function(){},e.prototype.extend=function(e,t){return null},e.prototype.subscribe=function(e,t,n,r){},e.prototype.unsubscribe=function(e,t,n){},e.prototype.once=function(e,t,n){},e.prototype.createFacade=function(e,t,n){if(!t.mediator||n.mediator instanceof C){var r;return n.mediator?(n.mediator.updateFacade(t,this),r=n.mediator):r=n.mediator=t.mediator=new C(t,this),r}throw new Error('"mediator" is a reserved property')},e.config=g,e}();t.Mediator=k,l.extend(k.prototype,p)}),define("thrust/mediator",["thrust/mediator/main"],function(e){return e}),define("thrust/mediator/convention/autostart",["require","exports","thrust/convention"],function(e,t,n){var r=n,i=r.Convention,s={properties:["autoStart"]};t.autostart=new i(s)}),define("thrust/mediator/convention/container",["require","exports","thrust/convention","thrust/util"],function(e,t,n,r){var i=n,s=i.Convention,o=r,u=o._,a={anyContainer:"thrust/mediator/convention/container/any",changeContainer:"thrust/mediator/convention/container/change"},f=u.any,l=u.bind,c="container",h="start-status",p=u.defer,d={properties:[c],change:function(e,t){var n=e.convention(c);n&&t&&n===t&&e.convention(h)&&p(l(e.stop,e))},start:function(e,t){var n=this,r=t.convention(c);return r&&(e.fire(a.changeContainer,r),e.subscribe(a.changeContainer,l(n.change,n,t))),undefined},stop:function(e,t){return undefined}};t.container=new s(d)}),define("thrust/mediator/convention/dependent.modules",["require","exports","thrust/convention","thrust/util"],function(e,t,n,r){var i=n,s=i.Convention,o=r,u=o._,a=u.any,f=u.map,l="dependentModules",c="childModules",h="start-status",p=u.defer,d=u.bind,v=function(e,t){var n=e.convention(l);if(n)return e.thrust[t](n)},m=function(e,t){var n=e.convention(c);if(n)return e.thrust[t](n)},g={properties:[l,c],start:function(e,t){return o.when.all(o.flattenToPromises([v(t,"start"),m(t,"start")]))},ready:function(e,t){if(!t.thrust.started)return o.when.all(o.flattenToPromises([v(t,"ready"),m(t,"ready")]))},stop:function(e,t){return m(t,"stop")},destroy:function(e,t){return m(t,"destroy")}};t.dependentModules=new s(g)}),define("thrust/mediator/convention/subscription",["require","exports","thrust/convention","thrust/util"],function(e,t,n,r){var i=n,s=i.Convention,o=r,u=o._,a="subscriptions",f=u.isFunction,l=u.isString,c=u.isArray,h={properties:[a],start:function(e,t){var n=t.convention(a);if(n&&!n._subscriptionsSet){var r=t.instance;for(var i in n){var s=n[i];f(s)?s=[i,s,r]:l(s)?s=[i,r[s],r]:c(s)&&(l(s[0])&&(s[0]=r[s[0]]),s.unshift(i)),e.subscribe.apply(e,s)}t.convention(a)._subscriptionsSet=!0}return null},stop:function(e,t){var n=t.convention(a);return n&&n._subscriptionsSet&&(t.convention(a)._subscriptionsSet=!1),null}};t.subscription=new s(h)});